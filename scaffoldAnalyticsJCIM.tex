
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% This is a (brief) model paper using the achemso class
%% The document class accepts keyval options, which should include
%% the target journal and optionally the manuscript type.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\documentclass[journal=jacsat,manuscript=article]{achemso}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Place any additional packages needed here.  Only include packages
%% which are essential, to avoid problems later. Do NOT use any
%% packages which require e-TeX (for example etoolbox): the e-TeX
%% extensions are not currently available on the ACS conversion
%% servers.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%\usepackage[version=3]{mhchem} % Formula subscripts using \ce{}
\usepackage[T1]{fontenc}       % Use modern font encodings
\usepackage{hyperref}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% If issues arise when submitting your manuscript, you may want to
%% un-comment the next line.  This provides information on the
%% version of every file you have used.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%\listfiles

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Place any additional macros here.  Please use \newcommand* where
%% possible, and avoid layout-changing macros (which are not used
%% when typesetting).
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand*\mycommand[1]{\texttt{\emph{#1}}}
\newcommand*\fref[1]{Figure \ref{fig:#1}}
\newcommand*\tref[1]{Table \ref{table:#1}}
\newcommand*\sref[1]{Section \ref{sec:#1}}
\newcommand*\eg{e.g.~}
\newcommand*\ie{i.e.~}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Meta-data block
%% ---------------
%% Each author should be given as a separate \author command.
%%
%% Corresponding authors should have an e-mail given after the author
%% name as an \email command. Phone and fax numbers can be given
%% using \phone and \fax, respectively; this information is optional.
%%
%% The affiliation of authors is given after the authors; each
%% \affiliation command applies to all preceding authors not already
%% assigned an affiliation.
%%
%% The affiliation takes an option argument for the short name.  This
%% will typically be something like "University of Somewhere".
%%
%% The \altaffiliation macro should be used for new address, etc.
%% On the other hand, \alsoaffiliation is used on a per author basis
%% when authors are associated with multiple institutions.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\author{Deepak Bandyopadhyay}
\email{deepak.2.bandyopadhyay@gsk.com}
\author{Constantine Kreatsoulas}
\author{Pat G. Brady}
\author{Joseph Boyer}
\author{Zangdong He}
\author{Genaro Scavello Jr.}
\affiliation[GSK]{GlaxoSmithKline, 1250 S. Collegeville Rd, Collegeville, PA 19426}
\author{Dac-Trung Nguyen}
\author{Tyler Peryea}
\author{Rajarshi Guha}
\email{guhar@mail.nih.gov}
\author{Ajit Jadhav}
\email{ajadhav@mail.nih.gov}
%\phone{+123 (0)123 4445556}
%\fax{+123 (0)123 4445557}
\affiliation[NCATS]{National Center for Advancing Translational Science, 9800 Medical Center Drive, Rockville, MD 20850}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% The document title should be given as usual. Some journals require
%% a running title from the author: this should be supplied as an
%% optional argument to \title.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\title[Scaffold Analytics] {Scaffold-Based Analytics: Enabling Hit-to-Lead
  Decisions by Visualizing Chemical Series Linked Across Large Datasets}  

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Some journals require a list of abbreviations or keywords to be
%% supplied. These should be set up here, and will be printed after
%% the title and author information, if needed.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\abbreviations{IR,NMR,UV}
%\keywords{American Chemical Society, \LaTeX}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% The manuscript does not need to include \maketitle, which is
%% executed automatically.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{document}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% The "tocentry" environment can be used to create an entry for the
%% graphical table of contents. It is given here as some journals
%% require that it is printed as part of the abstract page. It will
%% be automatically moved as appropriate.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{tocentry}

Some journals require a graphical entry for the Table of Contents.
This should be laid out ``print ready'' so that the sizing of the
text is correct.

Inside the \texttt{tocentry} environment, the font used is Helvetica
8\,pt, as required by \emph{Journal of the American Chemical
Society}.

The surrounding frame is 9\,cm by 3.5\,cm, which is the maximum
permitted for  \emph{Journal of the American Chemical Society}
graphical table of content entries. The box will not resize if the
content is too big: instead it will overflow the edge of the box.

This box and the associated title will always be printed on a
separate page at the end of the document.

\end{tocentry}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% The abstract environment will automatically gobble the contents
%% if an abstract is not used by the target journal.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{abstract}
  We present a method for visualizing and navigating large and diverse chemical spaces, such as screening datasets, along with their activities and properties. Our approach is to annotate the data with all possible scaffolds contained within each molecule using an exhaustive algorithm developed at NCATS.  We have developed a Spotfire visualization that is used to drive the hit triage process. Progression decisions can be made using aggregate scaffold parameters and data from multiple datasets merged at the scaffold level.  This visualization easily reveals overlaps that help prioritize hits, highlight tractable series and posit ways to combine aspects of multiple hits.  The SAR of a large and complex hit is automatically mapped into all constituent scaffolds making it possible to navigate, via any shared scaffold, to all related hits.  This scaffold ``walking'' helps address bias toward a handful of potent and ligand-efficient molecules at the expense of coverage of chemical space. The mapping also automates the laborious process of substructure searches within a dataset as structures are now linked to pre-processed search results.  We compare the NCATS scaffold generation method with published screening triage methods such as nearest-neighbor clustering, data-driven clustering and scaffold networks.  We believe that our Spotfire visualization used in combination with structure annotation provides  a novel view of large and diverse datasets. This allows teams to effortlessly navigate between structurally related molecules and enriches the population of leads considered and progressed in a manner complementary to established approaches.
\end{abstract}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Start the main part of the manuscript here.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Introduction}

The advantage and disadvantage of high throughput screening (HTS) campaigns is
the large amount of data that is generated. While the value of large scale HTS
has been debated\cite{Macarron:2011qv}, the massive structure-activity
datasets generated create a challenge in identifying truly active compounds and
their analogs and weeding out false positives. The process of reducing HTS
datasets from hundreds of thousands of compounds to a few thousand or few
hundred active series is termed triaging. Over the last twenty years many
approaches to HTS triaging have been described which include activity based
thresholds [REF], similarity to known actives, enrichment based
approaches\cite{Varin2010CSE,Pu:2012wf}, ranges of physicochemical
properties\cite{Cox:2012qy}, crowdsourcing\cite{Peng:2013qp} and removal of
promiscuous or otherwise undesirable chemotypes \cite{Dahlin:2014fp}. See
\citeauthor{Shun:2011sy} and \citeauthor{Langer:2009mw} for a review of HTS
triage approaches.

One of the key challenges in the triage step is to identify structure-activity
series - sets of compounds with similar or analogous structures that exhibit a
spectrum of activity. Ideally, such a collection will also contain a number of
inactive compounds as well. Identifying such subsets allows one to have some
confidence in the presence of a structure-activity relationship amongst the
active compounds which enables a more efficient exploration of the chemical
space around the selected hits. A good review of computational methods to extract SAR from screening datasets can be found in \citeauthor{Wawer2010review}. 

Given that a SAR series is, ideally, defined in terms of a core structure along
with various decorations, a natural first step in the triage process is to
identify these core structures, termed scaffolds. Usually this starts by
decomposing the structures in the screening collection, either exhaustively or
else using one of the many methods to decompose structures into fragments such
as the Bemis-Murcko\cite{BemisMurcko1999,BemisMurcko1996} or RECAP
methods\cite{Lewell:1998aa}. These methods lead to a large number of
fragments ranging from trivial ones such as a benzene ring to very complex
multiring structures. Thus a key step involves identifying the relevant set of
scaffolds and their associated compounds. This can be challenging since a given
compound can contain multiple scaffolds.

In this work we present a HTS triage workflow based on navigating the
scaffold-activity landscape of a screening collection. The workflow includes
methods to visualize the activity landscape as well as methods to explore
different regions of chemical space via shared scaffolds. We also highlight the
efficiency gains obtained by using pre-computed scaffold associations rather
than performing substructure searches. \textbf{Is there a scaffold
  ranking/prioritization procedure that should/could be described?}

\subsection{Related Work}
As noted above there are many ways to generate scaffolds. A key is to identify a
relevant subset of them or else aggregate them in a way that leads to a useful
clustering of active and inactive compounds. While the term ``useful'' is rather
subjective, it is easy to identify cases that are \emph{not} useful. Thus, 5- or
6-member undecorated rings are likely not useful since they will occur in the
majority of compounds in a screening collection. At the other extreme, large,
extended scaffolds that are associated with very few compounds are also likely
not useful.

As a result, many approaches to scaffold aggregation have been described. A
natural approach is to consider a hierarchical aggregation. The Scaffold
Tree\cite{Ertl2011ScaffoldTree} and Scaffold Network\cite{Varin2011ScafNet}
define a hierarchical decomposition from more specialized larger scaffolds to
more inclusive smaller scaffolds. While the Scaffold Tree splits each larger
scaffold in exactly one way into two scaffolds with fewer rings, the Scaffold
Network performs an exhaustive decomposition into all possible smaller scaffolds
with fewer rings.  Since some subscaffolds are shared with neighboring
scaffolds, this produces a network or graph rather than a tree. The Scaffold
Network Generator program\cite{Matlock2013SNG} is a fast, easy-to-use public
command line implementation of Scaffold Networks that can scale to millions of
compounds via aggregation of scaffolds from split datasets and parallel
execution.  \citeauthor{Harper2004DDclus} use exhaustive enumeration to find all
Bemis-Murcko like frameworks in each molecule, and then recursively retain those
frameworks with highest aggregate activity and remove molecules that contain
them until a threshold is met, yielding a set of disjoint frameworks.  Other
methods have used multiple common substructure (MCS), first proposed for finding
protein structural similarity\cite{Koch1997MCSprot}, for example
\cite{Quintus2009MCS} and the ChemAxon product LibraryMCS.

To overcome the effect of small variations in heteroatoms (eg. O to S) mapping
otherwise similar molecules to different scaffolds, generalized or consolidated
scaffold representations have been proposed, such as the Reduced
Graph\cite{Barker2003RG}, the Bemis-Murcko scaffold\cite{BemisMurcko1996} and
the topological or 2D pharmacophore\cite{Schneider1999ScafHopTP}. Bemis-Murcko
like frameworks \cite{Harper2004DDclus} are generalized Bemis-Murcko scaffolds
where atom types and/or bond orders may be retained.

Multiple scaffolds if present in a dataset can be inferred from the scaffold
tree decomposition\cite{ClarkLabute2008SAReport}. However in practice, the
thresholds used by \citeauthor{ClarkLabute2008SAReport} miss common scaffolds in
HTS-like diverse chemical compound sets. \citeauthor{Bandyopadhyay2011ACS} have
used a common fragment decomposition plug-in for SAReport in order to find and
export scaffolds for diverse datasets, such as the GSK Natural Products Set\cite{Coma2014}.  This approach assigns at most one scaffold for each molecule, based on the order they are selected by the user from a prioritized list.   

Assigning each molecule to a single group partitions the dataset into disparate, non-overlapping groups.  This is also the way most fingerprint-based agglomerative clustering methods such as sphere exclusion, single and complete linkage clustering\textbf{Add Clustering Review} work. To see a figurative example where assigning a single group is limiting, consider trying to add the platypus to a clustering of known animals. We could pick up on its duck-like bill and add it to the cluster of ducks; or on its fur and overall shape and cluster it with the seals; or its flippers may be used to classify it as a penguin. Of course, the platypus has all these features but doesn't map to any one of these groups exclusively, so in practice we would call it a singleton and not connect it with any of the other clusters. Such a result can be observed in real chemical datasets as well -- for example, the complete-linkage clustering of the TCAMS dataset\cite{Gamo2010,Calderon2011} has nearly a fourth of the 2000 clusters containing just one element\ref{fig:CLcluster}.        

In contrast to these partitioning clusters, the methods described herein rely on fuzzy clustering, where a molecule may be in several clusters or contain several scaffolds. Fuzzy clusters have been rarely used in cheminformatics (for example \cite{Holliday2004}, \cite{Richmond2015Galois}), perhaps because they are hard to visualize and navigate.  In this work we provide an intuitive visual framework that we believe can help end users easily navigate a diverse chemical dataset describd by a fuzzy clustering of multiple overlapping scaffolds per molecule.    

\subsection{Datasets}
\label{sec:datasets}
The datasets used to illustrate and visualize our methods were picked to represent the kinds of screening datasets we expect the method to be used on in practice. For example, the TCAMS dataset\cite{Gamo2010} consists of 13.5k diverse hits from an antimalarial screen at GSK, along with pIC50 against a susceptible strain of the malarial parasite (3D7), percentage inhibition against a resistant strain (DD2), G2 hepatotoxicity, a few physical chemical properties (\eg molecular weight, aromatic ring count, cLogP), and Inhibition Frequency Index (IFI, a measure of promiscuity defined as the percentage of screens in which a molecule inhibits over 50\%, \cite{Chakravorty2013IFI}).   

The in-house kinase dataset shown, by contrast, is perhaps less diverse but chosen to illustrate the power of this approach in joining and merging datasets from multiple screens, combining their SAR to design hybrid molecules, and making inferences about unknown activity in one screen based on known activity in another screen.

These two and our other datasets are tabulated in \tref{dataset}, with references provided where available.

\section{Methods}
\label{sec:methods}

Next, we describe several methods we have assembled as part of our workflow that enable multiple scaffolds to be assigned to each molecule and easy navigation between molecules related by these scaffolds. 

%\begin{itemize}
%\item Scaffold decomposition algorithm, description
%\subitem Comparison with other decomposition algorithms
%\item Linking R-group tool to Spotfire
%\item Developing the Spotfire vis UI
%\end{itemize}
\subsection{Dataset Preprocessing}
\label{sec:prepro}
The typical dataset under consideration is available as a comma-separated text file (CSV), whereas more of the scaffold decomposition methods described expect MDL SD-files. To convert CSV to SDF, we have created a simple Pipeline Pilot workflow(\textbf{need to make available via supplementary material?}), and this task can also be done within molecular modeling programs such as MOE and toolkits such as ChemAxon's {JChem}.  Prior to SDF conversion, activity or property columns that are not to be aggregated at the scaffold level should be deleted from the CSV file, in order to speed up the analysis and aggregation.  There are some further quirks to pre-processing datasets for the NCATS R-group tool that will be described in the Supplementary Material.\textbf{follow through}  

\subsection{Fragmentation Method: NCATS R-Group Tool}
\label{sec:ncats}
The NCATS R-group analysis tool (\url{https://tripod.nih.gov/?p=46}) was developed to automatically and exhaustively generate R-group tables from a dataset using all scaffolds, defined as chemical substructures shared by two or more molecules. The scaffolds are defined as molecular fragments generated by exhaustive enumeration of all possible combinations of the Smallest Set of Smallest Rings (SSSR), as described at~\url{https://tripod.nih.gov/?p=160}. For a molecule with k SSSR, the maximum possible number of such scaffolds is $2^k - 1$; however the actual number is usually much lower due to symmetry and additional constraints (\eg reactivity, synthetic accessibility).      

As an example, in \fref{scafmethod}(b) we see the five scaffolds that were generated from the molecule shown in \fref{scafmethod}(a) from the TCAMS dataset.

\textbf{NCATS folks, please clarify and fill in any other relevant details}.

The NCATS R-group tool provides a Java-based UI for exploring the scaffolds found within a dataset and their individual R-group tables. The original tool released in 2010 has since been superseded by the NCATS Scaffold Hopper~\url{https://tripod.nih.gov/?p=483}.  In this work we've used a special version of the NCATS R-group tool that has scaffold export functionality, which can be downloaded from~\url{http://tripod.nih.gov/ws/rgroupbeta/rgrouptool8.jar}. We typically launch the GUI from Linux using the -Xmx16G switch to pre-reserve 16 gigabytes of RAM, which enables datasets of upto ~40k compounds with a handful of numeric activity columns to be analyzed without running out of memory. We export out both the R-group Decomposition (as tab-separated Text file) and also Scaffolds (in the same format). The format of these two files is described briefly below.

The R-group decomposition as exported has the following key columns:
\begin{itemize}
\item {\it Scaffold\_ID}: Numeric Scaffold Identifier.
\item {\it Scaffold SMILES}: Scaffold structure with attached R-group atoms.
\item {\it ID}: Numeric or text molecule identifier (name). Each molecule is repeated once for each scaffold that it occurs in.
\item {\it SMILES}: Molecule structure 
\item {\it $R_1..R_n$}: R-group SMILES, with \*-atoms at attachment points.
\item {\it Activity/Property columns}: Reproduced from original data for each molecule.
\end{itemize}

The Scaffold table as exported has the following key columns:
\begin{itemize}
\item {\it Structure}: Scaffold SMILES without R-groups attached. 
\item {\it $Scaffold\_ID$}: Numeric scaffold identifier. Each scaffold occurs only once, and data columns are aggregated for all molecules containing the scaffold.
\item {\it Complexity}: A number that captures increasing size and complexity of scaffolds - increases with number of rings, non-ring atoms, chiral atoms and ring adjacencies. \textbf{Trung or anyone else, would you like to provide more detail on this and the following scaffold metrics?}. Complexity can be used to prune away scaffolds that are too simple, by setting a cutoff such as 100.  
\item {\it Count}: Number of molecules that share this acaffold
\item {\it Score}: \textbf{Do we want to discuss and define this here?}
\item {\it Activity/Property $\pm$ Standard Deviation}: This is exported as a single aggregate column per property $Prop$, with two values separated by the $\pm$ sign. A Pipeline Pilot protocol was written to split out each such column into two separate columns, $Prop$ and $Prop\_SD$, which is made available via the Online Supplementary Material. 
\end{itemize}

\subsection{Fragmentation Method: GSK Frameworks}
\label{sec:gskframe}
The R-group Tool described above uses the NCATS implementation of molecular frameworks. GSK's implementation of Molecular Frameworks is subtly different, and its use has been described in \cite{Harper2004DDclus}.

\section{Results}

\section{Discussion}
\label{sec:discussion}

\begin{itemize}
\item Discuss performance - scaffold generation is usually a one time procedure
  for a given screening deck. Furthermore, the scaffold generating process will
  associate compounds with scaffolds, so looking up scaffold membership is very
  fast. When considering scaffold similarity, usual performance bottlenecks
  occur, same as for other similarity applications. Can we include some
  performance numbers?
\item we haven't discussed removal of promiscuous compounds/chemotypes,
  undesirable chemotypes (ie PAINS etc), these are generally a separate and
  independent step from the scaffold identification process
\item Ranking scaffolds is a key step in prioritizing hits in a scaffold-based
  approach. Still a subjective issue and many ways to do it. Not clear that
  there is a single optimal way
\item Privileged scaffolds - sometimes could go in looking for them, but usually
  one identifies such privileged scaffolds in a retrospective fashion, across
  multiple HTS campaigns. Relevance / importance to scaffold based triage?
\end{itemize}

\begin{acknowledgement}
  The GSK authors thank Subhas Chakravorty, Neysa Nevins, Ami Lakdawala Shah,
  Eric Manas, Todd Graybill, Stan Martens, Mike Ouellette, Tony Jurewicz and Rob
  Young for valuable feedback and suggestions while developing the method and
  visualizations.
\end{acknowledgement}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% The same is true for Supporting Information, which should use the
%% suppinfo environment.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{suppinfo}
Supplementary material is available online for this article.
\end{suppinfo}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% The appropriate \bibliography command should be placed here.
%% Notice that the class file automatically sets \bibliographystyle
%% and also names the section correctly.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\bibliography{bibliography}

\end{document}
